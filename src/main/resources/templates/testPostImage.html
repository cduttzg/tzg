<!doctype html>
<html>
    <head></head>
    <body>
        <input id='file' type='file' />
        <button id='upLoadFile'>up load file</button>
        <button id='login'>login</button>
        <script>
            let btn_1 = document.getElementById('upLoadFile');
            btn_1.onclick=function () {
                let formData = new FormData();
                let fileField = document.getElementById('file');
                formData.append('username','123');
                formData.append('avatar',fileField.files[0]);
                let url = '/test/image';
                let posts = Post(url, formData);
                console.log(posts);
            }
            let btn_2 = document.getElementById('login');
            btn_2.onclick=function () {
                let url = '/api/user/login';
                let data = {'用户名':'xx','密码':'sadasd'};
                data = JSON.stringify(data);
                let postsResule = Post(url, data);
                console.log(postsResule);
            }
            function Post(url, data){
                return fetch(url, {
                    method : "POST",
                    headers : new Headers({
                        'Content-Type': 'application/json'
                    }),
                    body : data
                }).then(response => {
                    return handlResponse(url, response);
                }).catch(error => {
                    console.error(`Requset failed. Url=${url}. Message=${error}`);
                    return {
                        error : {
                            messge : 'request failed'
                        }
                    };
                });
            }
        </script>
    </body>
</html>